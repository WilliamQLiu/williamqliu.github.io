<!DOCTYPE html>
<html>
<head>
   <title>R</title>
   <meta name="William Liu" content="William Liu" />

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />

   <!-- LaTeX support -->
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js">
     MathJax.Hub.Config({
     extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
     },
     "HTML-CSS": { availableFonts: ["TeX"] }
    });
   </script>

</head>

<body>
  <div class="site">
    <div class="title">
      <a href="/">William Liu</a>
    </div>

    <div id="post">
<h2 id="r">R</h2>

<hr />

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#summary">Summary</a></li>
  <li><a href="#setup">Setup</a>
    <ul>
      <li><a href="#installpackages">Install Packages</a></li>
      <li><a href="#commonpackages">Common Packages</a></li>
      <li><a href="#workdir">Setup a Working Directory</a></li>
      <li><a href="#help">Help</a></li>
    </ul>
  </li>
  <li><a href="#rdataframes">R Dataframes</a>
    <ul>
      <li><a href="#loadsave">R functions for loadind, saving files</a></li>
      <li><a href="#dataframes">Data frames</a></li>
      <li><a href="#listcbind">list(), cbind()</a></li>
      <li><a href="#datafunctions">Common Data Functions</a></li>
      <li><a href="#customfunctions">Creating a custom function</a></li>
      <li><a href="#datawidelong">Data Formatting to Wide and Long/molten forms</a></li>
      <li><a href="#datameltcast">Data Formatting with melt() and cast()</a></li>
      <li>[Data Filtering with by() and subset()][#datafilter]</li>
      <li><a href="#datafactors">Factors (coding variable, grouping variable)</a></li>
    </ul>
  </li>
  <li><a href="#ggplot2">Plot with ggplot2</a>
    <ul>
      <li><a href="#aes">aes</a></li>
      <li><a href="#geoms">geoms</a></li>
      <li><a href="#position">position</a></li>
      <li><a href="#facetgridwrap">facet_grid() and facet_wrap()</a></li>
      <li><a href="#statsummary">stat_summary()</a></li>
      <li><a href="#ggsave">ggsave()</a></li>
      <li><a href="#themeopts">theme() and opts()</a></li>
    </ul>
  </li>
  <li><a href="#statistics">Statistics</a>
    <ul>
      <li><a href="#normdist">Check for Normal Distribution</a></li>
    </ul>
  </li>
</ul>

<h2 id="a-idsummarysummarya"><a id="summary">Summary</a></h2>

<p><strong>R</strong> is an open source statistical computing program for data analysis.</p>

<h2 id="a-idsetupsetupa"><a id="setup">Setup</a></h2>

<p>Download <strong>R</strong> and the <strong>R Studio</strong> IDE.</p>

<h4 id="a-idinstallpackagesinstall-packagesa"><a id="installpackages">Install Packages</a></h4>

<p>You can expand R’s capabilities by installing packages from <strong>CRAN</strong> (Comprehensive R Archive Network).  You can also install packages from say GitHub.  To install a package from CRAN, you can do this a few different ways:</p>

<p><strong>Install a single package (every time)</strong></p>

<pre><code>install.packages("ggplot2", dependencies = TRUE)  # installs package 'ggplot2'
library(ggplot2)  # only need to install once, then can just reference
</code></pre>

<p><strong>Install a single package (checks if installed before)</strong></p>

<pre><code>if (!require("ggplot2")) {
    install.packages("ggplot2", dep=TRUE, repos="http://cran.rstudio.com/")
    library("ggplot2")
}
</code></pre>

<p><strong>Install a list of packages using a custom function</strong></p>

<pre><code>install &lt;- function(pkg){
  new.pkg &lt;- pkg[!(pkg %in% installed.packages()[, "Package"])]
  if(length(new.pkg))
      install.packages(new.pkg, dependencies=TRUE, repos="http://cran.rstudio.com/")
  sapply(pkg, require, character.only=TRUE)
}
packages &lt;- c("RODBC", "plyr", "knitr", "ggplot2")
install(packages)
</code></pre>

<p><strong>Install a list of packages using the pacman package</strong></p>

<pre><code>install.packages("pacman", repos="http://cran.rstudio.com")
pacman::p_load(RODBC, plyr, knitr, ggplot2)  # so meta!
</code></pre>

<h4 id="a-idcommonpackagescommon-packagesa"><a id="commonpackages">Common Packages</a></h4>

<p>Some common packages include:</p>

<ul>
  <li><strong>plyr</strong> # set of tools to break down data</li>
  <li><strong>ggplot2</strong> # nice way to plot your data by graphing layers</li>
  <li><strong>pacman</strong> # for installing packages</li>
  <li><strong>foreign</strong> # allows you to load data from SPSS and other formats</li>
  <li><strong>Rcmdr</strong> # allows data entry, make sure dependencies = TRUE</li>
  <li><strong>reshape</strong> # allows to change data from wide to long formats</li>
  <li><strong>pastecs</strong> # for basic descriptive statistics of variables; e.g. stat.desc()</li>
  <li><strong>RODBC</strong> # for conneting to databases (e.g. SQL Server)</li>
  <li><strong>WRS</strong> # for robust tests</li>
  <li><strong>Hmisc</strong> # for data analysis (e.g. correlations, computing sample size and power)</li>
  <li><strong>boot</strong> # for bootstrapping samples</li>
  <li><strong>car</strong> # for regression diagnostics</li>
  <li><strong>QuantPsyc</strong> # to get standardized regression coefficients</li>
</ul>

<h4 id="a-idworkdirsetup-a-working-directorya"><a id="workdir">Setup a Working Directory</a></h4>

<p>You can set a working directory (e.g. when you try to open up a file, this is the location it looks in)</p>

<pre><code>getwd()  # Gets the current directory
setwd()  # Sets the working directory (your default)
</code></pre>

<h4 id="a-idhelphelpa"><a id="help">Help</a></h4>

<p>R has built-in help that works well in RStudio by showing you how to use specific functions.</p>

<pre><code>help(myfunction)
?function
</code></pre>

<h2 id="a-idrdataframesr-data-framesa"><a id="rdataframes">R Data Frames</a></h2>

<p>As a bit of background, R is made up of <strong>objects</strong> and <strong>functions</strong>.  Here’s an example of creating an object (my_people) and assigning multiple names using the concatenate function <code>c()</code> with the strings <code>("Will", "Laura", "Mike", "Roger")</code>.</p>

<pre><code>my_people&lt;-c("Will", "Laura", "Mike", "Roger")  # variable can hold strings
my_age&lt;-c(30, 26, 33, 27)  # variable can hold numbers (no quotes)    
</code></pre>

<h4 id="a-idloadsavefunctions-for-loading-and-saving-filesa"><a id="loadsave">Functions for Loading and Saving Files</a></h4>

<p>Some example functions are loading data using <strong>read.csv()</strong> and <strong>write.csv()</strong>.  There’s also other varations including <strong>write.table()</strong></p>

<pre><code>mydata = read.csv(file="C:\\Users\\wliu\\Desktop\\myfile.csv")  # read file
mydata = write.csv(my_dataframe, "myfile.csv", sep=",", row.names=FALSE)
</code></pre>

<h4 id="a-iddataframesdata-framesa"><a id="dataframes">Data Frames</a></h4>
<p>Dataframes are specific objects that contain variables, like worksheets in Excel.</p>

<pre><code>family&lt;-data.frame(Name=my_people, Age=my_age)  # dataframe w/ 2 variables
family  # display contents of the entire dataframe
#  Name  Age
#1 Will  30
#2 Laura 26
#3 Mike  33
#4 Roger 27
family$Name  # can reference dataframe by variable (e.g. Name)
names()  # can list the variables in the dataframe  # Name, Age
new_family &lt;- family[2,c("Name")]  # rows, columns
# Laura
</code></pre>

<h4 id="a-idlistcbindlist-cbinda"><a id="listcbind">list(), cbind()</a></h4>

<p>The <code>list()</code> and <code>cbind()</code> functions can be used to combine variables (instead of dataframes).</p>

<pre><code>family&lt;-list(my_people, my_age)  # create two lists
# [1] "Will" "Laura" "Mike" Roger"
# [2] 30 26 33 27

family&lt;-cbind(my_people, my_age)  # paste columns of data together
#    my_people, my_age
#[1,] "Will", "30"  # Notice cbind() converts from int to string
#[2,] "Laura", "26"  # cbind() is good only for combining same data types
#[3,] "Mike", "33"
#[4,] "Roger", "27" 
</code></pre>

<h4 id="a-iddatafunctionscommon-data-functionsa"><a id="datafunctions">Common Data Functions</a></h4>

<ul>
  <li><strong>rowMeans()</strong> - mean of a row</li>
  <li><strong>rowSums()</strong> - sum of a row</li>
  <li><strong>sqrt()</strong> - square root</li>
  <li><strong>abs()</strong> - absolute value</li>
  <li><strong>log10()</strong> - base 10 logarithm</li>
  <li><strong>log()</strong> - natural logarithm</li>
  <li><strong>is.na()</strong> - check if value is missing</li>
  <li><strong>ifelse()</strong> - ifelse(a conditional argument, what happens if TRUE, what happens if FALSE)</li>
</ul>

<h4 id="a-idcustomfunctionscreating-a-custom-functiona"><a id="customfunctions">Creating a Custom Function</a></h4>

<pre><code>nameOfFunction &lt;- function(input1, input2)
{
    output &lt;- input1 + input2
    cat("Output is: ", output)
}
</code></pre>

<h4 id="a-iddatawidelongdata-formatting-wide-and-longmoltena"><a id="datawidelong">Data Formatting (wide and long/molten)</a></h4>

<p>The <strong>wide format</strong> formats data so that each row represents data from one entity while each column represents a variable.  There is no discrimination between independent and dependent variables (each should be its own column)</p>

<pre><code># Wide Format Example
# person, gender, happy_base, happy_6_months, happy_1_year
# Will,  Male, 2, 3, 4
# Laura, Female, 5, 6, 7
</code></pre>

<p>The <strong>long</strong> or <strong>molten format</strong> formats data so that scores on different variables (happiness over time) are placed in a single column.</p>

<pre><code># Long or Molten Format Example
# person, gender, variable, value
# Will,  Male, happy_base, 2
# Will,  Male, happy_6_months, 3
# Will,  Male, happy_1_year, 4
# Laura, Female, happy_base, 5
# Laura, Female, happy_6_months, 6
# Laura, Female, happy_1_year, 7 
</code></pre>

<h4 id="a-iddatameltcastdata-formatting-with-melt-and-casta"><a id="datameltcast">Data Formatting with melt() and cast()</a></h4>

<p>To reshape the data between <em>wide</em> and <em>long</em> formats, we can use these functions from the <strong>reshape</strong> package:</p>

<ul>
  <li><code>melt()</code> and <code>cast()</code></li>
  <li><code>stack()</code> and <code>unstack()</code></li>
</ul>

<h4 id="a-iddatafilterdata-filtering-with-by-and-subseta"><a id="datafilter">Data Filtering with by() and subset()</a></h4>

<p>To separate into different groups, we can use <code>by()</code> and <code>subset()</code>.</p>

<ul>
  <li><strong>by()</strong> - if you want to split data into different groups, you can use <code>by()</code> with the general form: <code>by(data = dataFrame, INDICES = grouping variable, FUN = a function that you want to apply to the data)</code></li>
  <li><strong>subset()</strong> - if you want to split data into different groups, you can use <code>subset()</code> with the general form: <code>subset(data = dataFrame, mycolumn==myvalue</code></li>
</ul>

<h4 id="a-iddatafactorsfactor-aka-coding-variable-grouping-variablea"><a id="datafactors">Factor (aka coding variable, grouping variable)</a></h4>

<p><strong>Factors</strong> are variables that take on a limited number of different values (i.e. <strong>categorical variables</strong>) and is helpful in statistical modeling.  Use the functions <code>factor()</code> (says this data is a categorical) and <code>levels()</code> (shows the different categories).</p>

<pre><code>data = c(1,2,2,3,1,2,3,3,1,2,3,3,1)
fdata = factor(data, levels=c(a,b,c), labels=("x","y","z")) # Levels: 1 2 3

my_months = c("January","February","March",
          "April","May","June","July","August","September",
          "October","November","December")
ordered_months = factor(my_months,levels=c("January","February","March",
                        "April","May","June","July","August","September",
                        "October","November","December"),ordered=TRUE)
ordered_months  # Levels: January &lt; February &lt; March &lt; April &lt; May &lt; June &lt; July &lt; August &lt; September &lt; October &lt; November &lt; December
</code></pre>

<h2 id="a-idggplot2plot-graphs-with-ggplot2a"><a id="ggplot2">Plot Graphs with ggplot2</a></h2>

<p>You can do a quick plot using <code>qplot()</code> (quick and easy) or build a plot layer by layer using <code>ggplot()</code> (for more detailed plots).  Plots are made up of <code>ggplot(myData, aes(variable for x, variable for y)) + geoms() + opts() + theme()</code>.  For full documentation, see: http://docs.ggplot2.org/</p>

<ul>
  <li><a id="aes"><strong>aes</strong></a> - aesthetic properties, what the <em>geoms</em> look like (e.g. size, color, shape) and where they’re plotted.  Examples include:
    <ul>
      <li><strong>colour()</strong> - specify exact colors using RRGGBB system (e.g. #3366FF) for a shade of blue</li>
      <li><strong>alpha()</strong> - specify transparency from 0 (for fully transparent) to 1 (fully opaque)</li>
      <li><strong>linetype()</strong> - specify if line is solid (1), hashed (2), dotted(3), dot and dash (4), long hash (5), dot and long hash (6)</li>
      <li><strong>size()</strong> - specify size in mm (default is 0.5); larger for larger, smaller for smaller</li>
      <li><strong>shape()</strong> - an int between 0 and 25, each specifying a type of shape, e.g. hollow square (0), hollow triangle (1), + sign (2)</li>
    </ul>
  </li>
  <li><a id="geoms"><strong>geoms</strong></a> - geometric objects, these are the visual elements of an object (e.g. bars, data points, text).  Each layer of the _geoms__ can accept additional arguments to change that layer’s <strong>aes</strong> (aesthetics).  Some common geoms include:
    <ul>
      <li><strong>geom_bar()</strong> - creates a layer with bars representing statistical properties</li>
      <li><strong>geom_point()</strong> - creates a layer showing the data points (e.g. scatterplot)</li>
      <li><strong>geom_line()</strong> - creates a layer that connects data points with a straight line</li>
      <li><strong>geom_smooth()</strong> - creates a layer that contains a smoother line</li>
      <li><strong>geom_histogram()</strong> - creates a layer with a histogram</li>
      <li><em>Note</em>: ggplot has some built-in <em>stats</em> functions (e.g. <em>bin</em> to bin data, <em>boxplot</em> to compute the data for a boxplot, <em>summary</em> to summarize data) that it uses behind the scenes.  You can adjust these properties manually if you’d like.  For a full list, look under ‘Statistics’ in the documentation.</li>
    </ul>
  </li>
  <li><a id="position"><strong>position</strong></a> - this is just an argument, but a useful one.  You can make position adjustments on any object (e.g. <em>geom</em> or <em>aes</em>) in a plot with the <code>position = "x"</code> where x can be:
    <ul>
      <li><strong>dodge</strong> - no overlap at the side</li>
      <li><strong>stackfill</strong> - makes objects stack on top of each other (largest objects on bottom, smallest on top) </li>
      <li><strong>fill</strong> - standardizes everything to an equal height (1) and makes objects stack on top of each other to fill the bar</li>
      <li><strong>identity</strong> - no position adjustment</li>
      <li><strong>jitter</strong> - jitter points to avoid overplotting on top of each other</li>
    </ul>
  </li>
  <li><a id="facetgridwrap"><strong>facet_grid() and facet_wrap()</strong></a> - faceting splits plots into subgroups.<br />
    <ul>
      <li><strong>facet_grid()</strong> - <em>facet grid</em> splits the data by the combination of  variables (e.g. Male Introverts, Female Introverts, Male Extroverts, Female Extroverts).  The general format is <code>+ facet_grid(x ~ y)</code> where <em>x</em> and <em>y</em> are the variables you want to facet</li>
      <li><strong>facet_wrap()</strong> - <em>facet wrap</em> splits the data by a single variable (e.g. Satisfied, Neutral, Not Satisfied). The general format is <code>+ facet_wrap( ~ y, nrow = integer, ncol = integer)</code> where <em>nrow</em> and <em>ncol</em> are optional</li>
    </ul>
  </li>
  <li><a id="statsummary"><strong>stat_summary()</strong></a> - summarizes y values at every unique x.  The general form is: <code>stat_summary(function = x, geom = y)</code>
    <ul>
      <li><strong>fun.y = mean</strong> - the mean; usually used with <em>geom = “bar”</em></li>
      <li><strong>fun.y = median</strong> - the median; usually used with <em>geom = “bar”</em></li>
      <li><strong>fun.data = mean_cl_normal()</strong> - 95% confidence intervals assuming normality; usually used with <em>geom = “errorbar”</em> or <em>geom = “pointrange”</em></li>
      <li><strong>fun.data = median_hilow()</strong> - median and upper and lower quantiles; usually used with <em>geom = “pointrange”</em></li>
    </ul>
  </li>
  <li>
    <p><a id="ggsave"><strong>ggsave()</strong></a> - lets you save the graph; E.g. <code>ggsave("mygraph.png", width = 2, height = 2)</code></p>
  </li>
  <li><a id="themeopts"><strong>theme() and opts()</strong></a> - <em>theme()</em> allows you to control the themes of how plots look, default is theme_grey().  <em>opts()</em> allows you to controls pecific parts of the theme (e.g. just the axis.line)
    <ul>
      <li><strong>theme_text()</strong> - font, colour, size of labels</li>
      <li><strong>theme_line()</strong> - colour, size, linetype for grid lines</li>
      <li><strong>theme_segment()</strong> - colour, size, linetype for axis line and axis tick marks</li>
    </ul>
  </li>
</ul>

<h2 id="a-idstatisticsstatisticsa"><a id="statistics">Statistics</a></h2>

<p>R really shines when it comes to statistical packages.  Here’s a few ways to do some statistical tests.  We won’t get into all the details of statistics here, just know there’s probably an R package.  See the statistics analysis guide for more details on what stats to use.</p>

<h2 id="a-idnormdistcheck-for-a-normal-distributiona"><a id="normdist">Check for a normal distribution</a></h2>

<p><strong>Shapiro-Wilk test</strong> used as a way to test for <em>normality (aka normal distribution)</em></p>

<pre><code>shapiro.test(variable)
</code></pre>

<p><strong>Q-Q plot (aka Quantile-Quantile plot)</strong> used as a way to test for <em>normality (aka normal distribution)</em> </p>

<pre><code>qplot(sample = rexam$exam, stat="qq")
</code></pre>

<p><strong>Levene’s Test</strong> tests the null hypothesis that the variances in different groups are equal (i.e. the difference between the variances is zero).  This is from the <em>car</em> package.  If <em>Levene’s Test</em> is significant (i.e. p&lt;=.05), then we can conclude the null hypothesis is incorrect and the <em>assumption of homogeneity of variances</em> is violated.  If <em>Levene’s Test</em> is non-significant (i.e. p&gt;.05) then the variances are roughly equal and the assumption holds true.</p>

<pre><code>leveneTest(outcome_variable, group, center = median/mean)
# where the outcome_variable is what we want to test the variances
# group variable is a factor
# center can be median or mean
</code></pre>

</div>

<div id="related">
  <h3>Related Posts</h3>
  <ul class="posts">
    
      <li><span>17 Oct 2015</span> <a href="/2015/10/17/django.html">Django Web Framework</a></li>
    
      <li><span>04 Oct 2015</span> <a href="/2015/10/04/testing.html">Testing</a></li>
    
      <li><span>03 Oct 2015</span> <a href="/2015/10/03/django-rest-framework.html">Django REST Framework (DRF)</a></li>
    
  </ul>
</div>

    <div class="footer">
      <div class="contact">
        <p>
          William Liu<br/>
        </p>
      </div>
      <div class="contact">
        <p>
          <a href="http://github.com/williamqliu/">github.com/williamqliu</a><br/>
        </p>
      </div>
    </div>
  </div>

  <!--
  <a href="http://github.com/williamqliu"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
  -->

  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-36019998-1', 'auto');
    ga('send', 'pageview');
  </script>
  <!-- Google Analytics end -->
</body>

</html>